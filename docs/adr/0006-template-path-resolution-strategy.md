# 6. Template path resolution strategy

Date: 2025-08-28

## Status

Accepted

## Context

There are some directories in the `backend/` directory that need to be found by flask
and flask extensions. These are:

- `static/` - the images, CSS and javascript served alongside the HTML generated by flask.
  Note that some of this is generated by a build step.
- `templates/` - the jinja2 templates used to produce the HTML.
- `translations/` - the home for translation files, required for internationalisation (i18n).

But when flask is installed in a virtualenv it is not obvious
where to look to find them. We could use:

- relative path - when not in virtualenv, or when using an "editable install".
- explicit path set by environment variable.
  - this would be annoying to have to always set.
- use the GITHUB_WORKSPACE environment variable (and then add `/backend/` to that path) - for when being run by GitHub Actions.
- the current working directory - assuming the process is running in that directory.

## Decision

On start up, we check all 4 of the above options, in order. We see if that directory exists
(assuming the environment variable is even set for the options that need one). Then we check
if all 3 of the expected subdirectories exist. Of those that match, we use the first one,
using the order above.

If no directory can be found which has the expected subdirectories, an exception will
be raised and the app should fail to start.

## Consequences

It is a little complicated, but it does mean that we'll never have an app running when
those directories don't exist. Failing early is generally preferred.

We don't check if the directories contain what we expect, but that would be unlikely. If
we do find cases where that issue arises we can make the code more robust.

We can easily add extra options to the list - mostly they will either duplicate an existing
option, or not contain the expected subdirectories, so there is little risk of confusion.

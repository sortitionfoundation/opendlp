{#
ABOUTME: Backoffice dashboard page showing user's assemblies
ABOUTME: Uses base_page.html for standard layout with navigation and footer
#}
{% extends "backoffice/base_page.html" %}
{% from "backoffice/components/card.html" import card, link_card %}
{% from "backoffice/components/button.html" import button %}

{% block title %}Dashboard{% endblock %}

{% block page_content %}
    <h1 style="color: var(--color-headings);" class="text-display-lg mb-2">Dashboard</h1>
    <p style="color: var(--color-secondary-text);" class="text-body-lg mb-8">Welcome back, {{ current_user.display_name }}!</p>

    <!-- Assemblies Section -->
    <section>
        <div class="flex justify-between items-center mb-6">
            <h2 style="color: var(--color-headings);" class="text-heading-lg">{{ _("Your Assemblies") }}</h2>
            {{ button(_("Create New Assembly"), href=url_for('backoffice.new_assembly'), variant="primary") }}
        </div>

        {% if assemblies %}
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                {% for assembly in assemblies %}
                    {% call link_card(href=url_for('backoffice.view_assembly', assembly_id=assembly.id), title=assembly.title, subtitle="Created: " ~ assembly.created_at.strftime("%b %d, %Y"), id="assembly-" ~ assembly.id, classes="assembly-card") %}
                        {% if assembly.question %}
                            <p style="color: var(--color-body-text);" class="text-body-md mb-4">
                                {{ assembly.question[:100] }}{% if assembly.question|length > 100 %}...{% endif %}
                            </p>
                        {% endif %}
                        {% if assembly.first_assembly_date %}
                            <p style="color: var(--color-secondary-text);" class="text-body-sm">
                                Starts: {{ assembly.first_assembly_date.strftime("%b %d, %Y") }}
                            </p>
                        {% endif %}
                    {% endcall %}
                {% endfor %}
            </div>
        {% else %}
            {% call card(id="no-assemblies-card") %}
                <p style="color: var(--color-body-text);" class="text-body-md mb-2">{{ _("No assemblies yet") }}</p>
                <p style="color: var(--color-secondary-text);" class="text-body-md mb-4">{{ _("Create your first citizens' assembly to get started.") }}</p>
                {{ button(_("Create Your First Assembly"), href=url_for('backoffice.new_assembly'), variant="primary") }}
            {% endcall %}
        {% endif %}
    </section>
{% endblock %}

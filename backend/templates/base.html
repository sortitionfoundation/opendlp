<!DOCTYPE html>
<html lang="en" class="govuk-template">
<head>
    <meta charset="utf-8">
    <title>{% block title %}OpenDLP - Open Democratic Lottery Platform{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0b0c0c">

    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="shortcut icon" sizes="16x16 32x32 48x48" href="/assets/images/favicon.ico" type="image/x-icon">
    <link rel="mask-icon" href="/assets/images/govuk-mask-icon.svg" color="#0b0c0c">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/govuk-apple-touch-icon-180x180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/assets/images/govuk-apple-touch-icon-167x167.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/images/govuk-apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" href="/assets/images/govuk-apple-touch-icon.png">

    <!-- OpenDLP with GOV.UK Frontend CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/application.css') }}">
    {% block extra_css %}{% endblock %}
</head>

<body class="govuk-template__body govuk-frontend-supported">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <a href="#main-content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

    <header class="govuk-header" role="banner" data-module="govuk-header">
        <div class="govuk-header__container govuk-width-container">
            <div class="govuk-header__logo">
                <a href="{{ url_for('main.index') }}" class="govuk-header__link govuk-header__link--homepage">
                    <img alt="Sortition Foundation Logo" src="{{ url_for('static', filename='img/logosortition.svg') }}">
                </a>
            </div>

            {% if current_user.is_authenticated %}
            <div class="govuk-header__content">
                <a href="#navigation" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" aria-label="Show or hide navigation menu">Menu</a>
                <nav class="govuk-header__navigation" id="navigation">
                    <button type="button" class="govuk-header__navigation-close govuk-js-header-toggle" aria-controls="navigation" aria-label="Close navigation menu">
                        <span class="govuk-visually-hidden">Close menu</span>
                    </button>
                    <ul class="govuk-header__navigation-list">
                        <li class="govuk-header__navigation-item">
                            <a class="govuk-header__link" href="{{ url_for('main.dashboard') }}">
                                {{ _('Dashboard') }}
                            </a>
                        </li>
                        <li class="govuk-header__navigation-item">
                            <a class="govuk-header__link" href="{{ url_for('main.assemblies') }}">
                                {{ _('Assemblies') }}
                            </a>
                        </li>
                        <li class="govuk-header__navigation-item">
                            <a class="govuk-header__link" href="https://www.sortitionfoundation.org/lab" target="_blank">
                                {{ _('Sortition Lab') }}
                            </a>
                        </li>
                        <li class="govuk-header__navigation-item">
                            <a class="govuk-header__link" href="{{ url_for('auth.logout') }}">
                                {{ _('Sign out') }} ({{ current_user.display_name }})
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
            {% else %}
            <div class="govuk-header__content">
                <a href="#navigation" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" aria-label="Show or hide navigation menu">Menu</a>
                <nav class="govuk-header__navigation" id="navigation">
                    <button type="button" class="govuk-header__navigation-close govuk-js-header-toggle" aria-controls="navigation" aria-label="Close navigation menu">
                        <span class="govuk-visually-hidden">Close menu</span>
                    </button>
                    <ul class="govuk-header__navigation-list">
                        <li class="govuk-header__navigation-item">
                            <a class="govuk-header__link" href="{{ url_for('auth.login') }}">
                                {{ _('Sign in') }}
                            </a>
                        </li>
                        <li class="govuk-header__navigation-item">
                            <a class="govuk-header__link" href="https://www.sortitionfoundation.org/lab" target="_blank">
                                {{ _('Sortition Lab') }}
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
            {% endif %}
        </div>
    </header>

    <div class="govuk-width-container">
        {% if get_flashed_messages() %}
            {% for category, message in get_flashed_messages(with_categories=true) %}
              {% if category == 'error' %}
                  <div class="govuk-error-summary" data-module="govuk-error-summary">
                    <div role="alert">
                      <h2 class="govuk-error-summary__title">
                        There is a problem
                      </h2>
                      <div class="govuk-error-summary__body">
                        {{ message }}
                      </div>
                    </div>
                  </div>
              {% else %}
                  <div
                    {% if category == 'success' %}
                    class="govuk-notification-banner govuk-notification-banner--success"
                    {% else %}
                    class="govuk-notification-banner"
                    {% endif %}
                    role="alert"
                    aria-labelledby="govuk-notification-banner-title"
                    data-module="govuk-notification-banner">
                      <div class="govuk-notification-banner__header">
                          <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
                            {% if category == 'success' %} Success {% else %} Important {% endif %}
                          </h2>
                      </div>
                      <div class="govuk-notification-banner__content">
                          <p class="govuk-notification-banner__heading">{{ message }}</p>
                      </div>
                  </div>
              {% endif %}
            {% endfor %}
        {% endif %}

        <main class="govuk-main-wrapper" id="main-content" role="main">
            {% block content %}{% endblock %}
        </main>
    </div>

    <footer class="govuk-footer" role="contentinfo">
        <div class="govuk-width-container">
            <div class="govuk-footer__meta">
                <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">
                    <h2 class="govuk-visually-hidden">Support links</h2>
                    <ul class="govuk-footer__inline-list">
                        <li class="govuk-footer__inline-list-item">
                            <a class="govuk-footer__link" href="https://github.com/sortition-foundation/opendlp" target="_blank">
                                GitHub
                            </a>
                        </li>
                        <li class="govuk-footer__inline-list-item">
                            <a class="govuk-footer__link" href="https://www.sortitionfoundation.org" target="_blank">
                                Sortition Foundation
                            </a>
                        </li>
                    </ul>

                    <div class="govuk-footer__meta-custom">
                        <p class="govuk-body-s">
                            OpenDLP is an open source platform for Democratic Lottery and Citizens' Assembly management.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/govuk-frontend@5.11.1/dist/govuk/all.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof window.GOVUKFrontend !== 'undefined') {
                window.GOVUKFrontend.initAll();
            }
        });
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>
